import{d as B,D,b as h,c as $,w as y,e as I,a as M,T as ce,h as A,z as j,U as ue,_ as V,s as G,k as H,J as v,o as se,L as Z,l as L,F as q,r as z,x as U,O as Q,C as T,W as fe,q as oe,X as me,m as F,Y as ae,Z as re,$ as ne,a0 as he,a1 as pe,a2 as X,a3 as Ce,a4 as ge}from"./index-Bi-DHOAI.js";const Se=B({__name:"CardWord",props:{word:{type:String,required:!0}},setup(e){return(n,r)=>{const l=D("ion-text");return h(),$(M(ue),{color:"primary"},{default:y(()=>[I(M(ce),{class:"content"},{default:y(()=>[I(l,null,{default:y(()=>[A(j(e.word),1)]),_:1})]),_:1})]),_:1})}}}),de=V(Se,[["__scopeId","data-v-3dc2538c"]]),xe={class:"cards"},We=B({__name:"WordsCardSelect",setup(e){const n=Y(),{cards:r,currentWord:l}=G(n),s=H(),d=v(""),u=v([]),i=v("danger"),S=v("success");se(()=>{w()}),Z(l,f=>s.speakText((f==null?void 0:f.word)||""));const _=(f,x)=>{if(d.value)return;let g=2e3;d.value=f.word;const p=r.value.findIndex(t=>t.word===l.value.word);u.value[p]=S.value,l.value.word!==f.word&&(g=3e3,u.value[x]=i.value);const C=l.value.word===f.word;n.setAnswer(f,C),setTimeout(()=>{n.setNextWord(),w()},g)},w=()=>{u.value=r.value.map(()=>"medium"),d.value=""};return(f,x)=>(h(),L("div",xe,[(h(!0),L(q,null,z(M(r),(g,p)=>(h(),$(de,{class:U(["cards__card",u.value[p]===i.value?"cards__error":u.value[p]===S.value?"cards__success":""]),color:u.value[p],key:g.word,word:g.translation,onClick:C=>_(g,p)},null,8,["class","color","word","onClick"]))),128))]))}}),ke=V(We,[["__scopeId","data-v-f43d60e3"]]),we={class:"cards"},ye=B({__name:"WordsListSelect",setup(e){const n=Y(),{cards:r,currentWord:l}=G(n),s=H(),d=v(""),u=v([]),i=v("danger"),S=v("success");se(()=>{w()});const _=(f,x)=>{var t;if(d.value)return;let g=2e3;d.value=f.word;const p=r.value.findIndex(c=>c.word===l.value.word);u.value[p]=S.value,l.value.word!==f.word&&(g=3e3,u.value[x]=i.value),s.speakText(((t=l.value)==null?void 0:t.word)||"");const C=l.value.word===f.word;n.setAnswer(l.value,C),setTimeout(()=>{n.setNextWord(),w()},g)},w=()=>{u.value=r.value.map(()=>"medium"),d.value=""};return(f,x)=>(h(),L("div",we,[(h(!0),L(q,null,z(M(r),(g,p)=>(h(),$(de,{class:U(["cards__card",u.value[p]===i.value?"cards__error":u.value[p]===S.value?"cards__success":""]),color:u.value[p],key:g.word,word:g.word,onClick:C=>_(g,p)},null,8,["class","color","word","onClick"]))),128))]))}}),Le=V(ye,[["__scopeId","data-v-df948bb3"]]),Ie={class:"wrapper-letter"},be=B({__name:"LetterCard",props:{letter:{type:Object,required:!0},count:{type:Number,required:!1,default:0}},setup(e){return(n,r)=>{const l=D("ion-text"),s=D("ion-badge");return h(),L("div",Ie,[I(M(ue),{color:"medium",class:"letter"},{default:y(()=>[I(M(ce),{class:"letter__content content ion-no-padding"},{default:y(()=>[I(l,{class:"content__text"},{default:y(()=>[A(j(e.letter),1)]),_:1})]),_:1})]),_:1}),e.count>1?(h(),$(s,{key:0,class:"badge"},{default:y(()=>[A(j(e.count),1)]),_:1})):Q("",!0)])}}}),Te=V(be,[["__scopeId","data-v-978ab0e5"]]),Me={class:"letter-select"},Ne={key:0,class:"letter-select__header header"},Re={key:1,class:"letter-select__card"},$e={class:"letter-select__result result"},Oe=B({__name:"WordsLetterSelect",setup(e){const n=Y(),{currentWord:r}=G(n),l=H(),s=v([]),d=v([]),u=v(!1),i=v(!1),S=v(!0);se(()=>{w(),x()}),Z(r,()=>{w()}),Z(i,()=>{i.value||w()});const _=T(()=>{var t;const C=(t=r.value)!=null&&t.word?r.value.word.length-d.value.length:0;return d.value.join("")+" _ ".repeat(C)}),w=()=>{var t;const C=(t=r.value)==null?void 0:t.word.split("").sort(()=>Math.random()-.5);s.value=C.reduce((c,o)=>{const a=c.find(b=>b.letter===o);return a?a.counter+=1:c.push({letter:o,selected:0,counter:1}),c},[])},f=C=>{var t,c;if(d.value.push(C),s.value.forEach(o=>{o.letter===C&&o.selected++}),((t=r.value)==null?void 0:t.word.length)===d.value.length){const o=d.value.join("");u.value=!0,l.speakText(((c=r.value)==null?void 0:c.word)||""),r.value.word===o?(S.value=!1,n.setAnswer(r.value,!0),setTimeout(()=>{n.setNextWord(),x()},3e3)):i.value=!0}},x=()=>{d.value=[],u.value=!1,i.value=!1,S.value=!0},g=()=>{if(!d.value.length)return;const C=d.value.pop();C&&s.value.forEach(t=>{t.letter===C&&t.selected--})},p=()=>{n.setNextWord(),x()};return(C,t)=>{const c=D("ion-text"),o=D("ion-button");return h(),L("div",Me,[S.value?(h(),L("div",Ne,[I(c,{class:"header__text"},{default:y(()=>[A(j(_.value),1)]),_:1}),I(M(oe),{class:"header__delete",icon:M(fe),size:"large",onClick:t[0]||(t[0]=a=>g())},null,8,["icon"])])):Q("",!0),S.value?(h(),L("div",Re,[(h(!0),L(q,null,z(s.value,a=>(h(),L(q,{key:a.letter},[a.counter!==a.selected?(h(),$(Te,{key:0,letter:a.letter,count:a.counter-a.selected,onClick:b=>f(a.letter)},null,8,["letter","count","onClick"])):(h(),$(M(oe),{key:1,icon:M(me),size:"small"},null,8,["icon"]))],64))),128))])):Q("",!0),F("div",$e,[I(ne,{name:"bounce"},{default:y(()=>[ae(I(c,{class:"result__translation"},{default:y(()=>{var a;return[A(j((a=M(r))==null?void 0:a.word),1)]}),_:1},512),[[re,u.value]])]),_:1}),I(ne,{name:"slide-fade"},{default:y(()=>[ae(I(o,{class:"result__translation",onClick:p},{default:y(()=>[A(" Понял ")]),_:1},512),[[re,i.value]])]),_:1})])])}}}),Ae=V(Oe,[["__scopeId","data-v-d2bc6917"]]),le=B({__name:"WordsMatchCard",props:{word:{type:String,required:!0},color:{type:String,required:!1,default:""}},setup(e){return(n,r)=>{const l=D("ion-card-content"),s=D("ion-card");return h(),$(s,{color:e.color},{default:y(()=>[I(l,null,{default:y(()=>[A(j(e.word),1)]),_:1})]),_:1},8,["color"])}}}),De={class:"match"},Be=B({__name:"WordsMatchSelect",setup(e){const n=Y(),{cards:r}=G(n),l=H(),s=v([]),d=v(""),u=v(null),i=T(()=>r.value.map(t=>t.word).sort(()=>Math.random()-.5)),S=T(()=>r.value.map(t=>t.translation).sort(()=>Math.random()-.5)),_=t=>{l.speakText(t),x(t)},w=t=>{x(t)},f=T(()=>s.value.at(-1)),x=t=>{var c,o,a;if(d.value="",((c=f.value)==null?void 0:c.length)===1&&((o=f.value)!=null&&o.includes(t)))s.value.pop();else{if(s.value.some(b=>b.includes(t)))return;if(s.value.every(b=>b.length===2))s.value.push([t]);else{const b=((a=f.value)==null?void 0:a[0])||"",J=r.value.find(E=>E.word===b),K=r.value.find(E=>E.translation===b);g(J,K,t)}}C()},g=(t,c,o)=>{u.value&&clearTimeout(u.value);const a=s.value.at(-1);t&&(t==null?void 0:t.translation)===o||c&&(c==null?void 0:c.word)===o?a==null||a.push(o):/[А-Яа-яЁё]/.test((a==null?void 0:a[0])||"")&&/[А-Яа-яЁё]/.test(o)||!/[А-Яа-яЁё]/.test((a==null?void 0:a[0])||"")&&!/[А-Яа-яЁё]/.test(o)?(s.value.pop(),s.value.push([o])):(d.value=o,u.value=setTimeout(()=>d.value="",3e3))},p=t=>s.value.some(c=>c.length===2&&c.includes(t))?"success":s.value.some(c=>c.includes(t))?"primary":d.value===t?"danger":"",C=()=>{var t;s.value.length===4&&((t=s.value.at(-1))==null?void 0:t.length)===2&&(setTimeout(()=>n.setNextWord(),3e3),n.setAnswer(null,!0))};return(t,c)=>(h(),L("div",De,[F("div",null,[(h(!0),L(q,null,z(i.value,o=>(h(),$(le,{class:U(["match__word",o===d.value?"match__error":""]),key:o,word:o,color:p(o),onClick:a=>_(o)},null,8,["class","word","color","onClick"]))),128))]),F("div",null,[(h(!0),L(q,null,z(S.value,o=>(h(),$(le,{class:U(["match__translation",o===d.value?"match__error":""]),key:o,word:o,color:p(o),onClick:a=>w(o)},null,8,["class","word","color","onClick"]))),128))])]))}}),Ee=V(Be,[["__scopeId","data-v-280546b7"]]);var ee=(e=>(e.Random="Random",e.Card="Card",e.List="List",e.Img="Img",e))(ee||{}),R=(e=>(e.Card="Card",e.List="List",e.Words="Words",e.Match="Match",e))(R||{});const je={Card:ke,List:Le,Words:Ae,Match:Ee};var te=(e=>(e.Random="Random",e.A1="A1",e.A2="A2",e.B1="B1",e.B2="B2",e.C1="C1",e.C2="C2",e.Pronoun="pronoun",e.Number="number",e.Auto="auto",e.Airport="airport",e.Journey="journey",e.Government="government",e.Health="health",e.Business="business",e.Science="science",e.Food="food",e.Culture="culture",e.Fitness="fitness",e.Fashion="fashion",e.Ecology="ecology",e.Socialissues="socialissues",e.Home="home",e))(te||{});const Ue=["Words","List"],Y=he("wordsStore",()=>{const e=pe(),n=v([]),r=v(0),l=v([]),s=v([]),d=v(te.Random),u=v(!1),i=v([]),S=v(ee.Card),_=v(R.Card),w=T(()=>i.value[r.value]),f=T(()=>je[_.value]),x=T(()=>Object.values(R).indexOf(_.value)),g=T(()=>Object.values(R).length),p=T(()=>!!s.value.length&&!!i.value&&s.value.length>=i.value.length&&s.value.every(m=>m.isCorrect.length>=i.value.length)),C=T(()=>s.value.reduce((m,W)=>m+W.isCorrect.length,0)*6.3/100),t=T(()=>X.length),c=(m=3)=>{if(_.value===R.Match)l.value=i.value;else{const W=JSON.parse(localStorage.getItem(Ce)||"[]"),k=W.length?n.value.filter(O=>!W.find(_e=>O.word===_e.word)):n.value,N=k.length,P=[];for(let O=0;O<m;O++)P.push(Math.floor(Math.random()*N));const ie=Math.floor(Math.random()*(l.value.length+1));k.length?l.value=P.map(O=>k[O]):(l.value=P.map(O=>n.value[O]),e.addNotification("Вы уже изучили слова из этой категории. Давайте повторим их!","success")),l.value.splice(ie,0,w.value);const ve=k.length?k:n.value;ge(l.value,ve,"word")}},o=(m=4)=>{const W=n.value.length,k=[];for(let N=0;N<m;N++)k.push(Math.floor(Math.random()*W));i.value=k.map(N=>n.value[N])},a=()=>{u.value?J():r.value<3&&_.value!==R.Match?r.value++:(r.value=0,b())},b=()=>{const m=Object.values(R);x.value<g.value-1?_.value=m[x.value+1]:_.value===R.Match&&!p.value?(u.value=!0,J()):_.value=m[0]},J=()=>{r.value=10;const m=s.value.find(W=>W.isCorrect.length<i.value.length);if(m){_.value=m.studyCard;const W=i.value.filter(k=>m.isCorrect.findIndex(N=>k.word===N.word)===-1);W.length?r.value=i.value.findIndex(k=>k.word===W[0].word):u.value=!1}else u.value=!1},K=()=>{a(),E()},E=()=>{c()};return{cards:l,currentWord:w,currentFlow:d,activeFlowWords:S,selectedCardViewWord:f,selectedCardView:_,isCompleted:p,progressBarStudyCount:C,flowWords:s,studyWords:i,countAllWords:t,setNextWord:K,setRandomCards:c,initializeWordsList:m=>{d.value=m,te.Random===m?n.value=X:n.value=X.filter(W=>W.levels.includes(m)),o(),E()},setAnswer:(m,W)=>{if(!m||_.value===R.Match)s.value.push({studyCard:_.value,isCorrect:i.value});else if(W){const k=s.value.findIndex(N=>N.studyCard===_.value);k>-1?s.value[k].isCorrect.push(m):s.value.push({studyCard:_.value,isCorrect:[m]})}},resetFlow:()=>{r.value=0,s.value=[],u.value=!1,i.value=[],S.value=ee.Card,_.value=R.Card}}});export{te as F,R as V,Ue as a,Y as w};
